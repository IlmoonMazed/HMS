{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\User\\\\Desktop\\\\VS_CODE\\\\Shinigamis_Homework\\\\HMS\\\\src\\\\pages\\\\UpdateProfile2.js\",\n    _s = $RefreshSig$();\n\nimport { useEffect, useState } from \"react\";\nimport { useNavigate } from \"react-router-dom\";\nimport { getCookie } from \"../utils/cookie\";\nimport supabase from \"../config/supabaseClient\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst UpdateProfile2 = () => {\n  _s();\n\n  const navigate = useNavigate();\n  const userId = getCookie('user_id');\n  const [height, setHeight] = useState(\"\");\n  const [weight, setWeight] = useState(\"\");\n  const [bloodType, setBloodType] = useState(\"\");\n  const [emergencyContact, setEmergencyContact] = useState(\"\");\n  const [formError, setFormError] = useState(null);\n  useEffect(() => {\n    const fetchProfile = async () => {\n      if (!userId) {\n        setFormError(\"User not logged in\");\n        return;\n      }\n\n      const {\n        data,\n        error\n      } = await supabase.from(\"Patient\").select(\"Height, Weight, Blood_Type, Emergency_Contact\").eq(\"User_ID\", userId).single();\n\n      if (error && error.code !== \"PGRST116\") {\n        console.log(error);\n        setFormError(\"Could not fetch profile data\");\n      }\n\n      if (data) {\n        setHeight(data.Height || \"\");\n        setWeight(data.Weight || \"\");\n        setBloodType(data.Blood_Type || \"\");\n        setEmergencyContact(data.Emergency_Contact || \"\");\n      }\n    };\n\n    fetchProfile();\n  }, [userId]);\n\n  const handleUpdate = async e => {\n    e.preventDefault();\n\n    if (!userId) {\n      setFormError(\"User not logged in\");\n      return;\n    }\n\n    const {\n      data: existing\n    } = await supabase.from(\"Patient\").select(\"User_ID\").eq(\"User_ID\", userId).single();\n    let result;\n\n    if (existing) {\n      result = await supabase.from(\"Patient\").update({\n        Height: height,\n        Weight: weight,\n        Blood_Type: bloodType,\n        Emergency_Contact: emergencyContact\n      }).eq(\"User_ID\", userId);\n    } else {\n      result = await supabase.from(\"Patient\").insert({\n        User_ID: userId,\n        Height: height,\n        Weight: weight,\n        Blood_Type: bloodType,\n        Emergency_Contact: emergencyContact,\n        Referential_Code: 0 // or generate if needed\n\n      });\n    }\n\n    if (result.error) {\n      console.log(result.error);\n      setFormError(\"Update failed\");\n    } else {\n      setFormError(null);\n      navigate(\"/\"); // or wherever you want to redirect\n    }\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"update-profile\",\n    children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n      children: \"Update Patient Profile\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 94,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n      onSubmit: handleUpdate,\n      children: [/*#__PURE__*/_jsxDEV(\"label\", {\n        children: \"Height (cm):\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 96,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"number\",\n        value: height,\n        onChange: e => setHeight(e.target.value)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 97,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n        children: \"Weight (kg):\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 103,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"number\",\n        value: weight,\n        onChange: e => setWeight(e.target.value)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 104,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n        children: \"Blood Type:\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 110,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n        value: bloodType,\n        onChange: e => setBloodType(e.target.value),\n        children: [/*#__PURE__*/_jsxDEV(\"option\", {\n          value: \"\",\n          children: \"Select blood type\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 115,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n          value: \"A+\",\n          children: \"A+\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 116,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n          value: \"A-\",\n          children: \"A-\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 117,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n          value: \"B+\",\n          children: \"B+\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 118,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n          value: \"B-\",\n          children: \"B-\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 119,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n          value: \"AB+\",\n          children: \"AB+\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 120,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n          value: \"AB-\",\n          children: \"AB-\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 121,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n          value: \"O+\",\n          children: \"O+\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 122,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n          value: \"O-\",\n          children: \"O-\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 123,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 111,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n        children: \"Emergency Contact:\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 126,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"text\",\n        placeholder: \"+880 1X XXXXXXXX\",\n        value: emergencyContact,\n        onChange: e => setEmergencyContact(e.target.value)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 127,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        type: \"submit\",\n        children: \"Update Profile\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 134,\n        columnNumber: 9\n      }, this), formError && /*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"error\",\n        children: formError\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 136,\n        columnNumber: 23\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 95,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 93,\n    columnNumber: 5\n  }, this);\n};\n\n_s(UpdateProfile2, \"NA3ZTNnkKyEKYvU6hg4jJhxlbEs=\", false, function () {\n  return [useNavigate];\n});\n\n_c = UpdateProfile2;\nexport default UpdateProfile2;\n\nvar _c;\n\n$RefreshReg$(_c, \"UpdateProfile2\");","map":{"version":3,"names":["useEffect","useState","useNavigate","getCookie","supabase","UpdateProfile2","navigate","userId","height","setHeight","weight","setWeight","bloodType","setBloodType","emergencyContact","setEmergencyContact","formError","setFormError","fetchProfile","data","error","from","select","eq","single","code","console","log","Height","Weight","Blood_Type","Emergency_Contact","handleUpdate","e","preventDefault","existing","result","update","insert","User_ID","Referential_Code","target","value"],"sources":["C:/Users/User/Desktop/VS_CODE/Shinigamis_Homework/HMS/src/pages/UpdateProfile2.js"],"sourcesContent":["import { useEffect, useState } from \"react\";\r\nimport { useNavigate } from \"react-router-dom\";\r\nimport { getCookie } from \"../utils/cookie\";\r\nimport supabase from \"../config/supabaseClient\";\r\n\r\nconst UpdateProfile2 = () => {\r\n  const navigate = useNavigate();\r\n  const userId = getCookie('user_id');\r\n\r\n  const [height, setHeight] = useState(\"\");\r\n  const [weight, setWeight] = useState(\"\");\r\n  const [bloodType, setBloodType] = useState(\"\");\r\n  const [emergencyContact, setEmergencyContact] = useState(\"\");\r\n  const [formError, setFormError] = useState(null);\r\n\r\n  useEffect(() => {\r\n    const fetchProfile = async () => {\r\n      if (!userId) {\r\n        setFormError(\"User not logged in\");\r\n        return;\r\n      }\r\n\r\n      const { data, error } = await supabase\r\n        .from(\"Patient\")\r\n        .select(\"Height, Weight, Blood_Type, Emergency_Contact\")\r\n        .eq(\"User_ID\", userId)\r\n        .single();\r\n\r\n      if (error && error.code !== \"PGRST116\") {\r\n        console.log(error);\r\n        setFormError(\"Could not fetch profile data\");\r\n      } \r\n\r\n      if (data) {\r\n        setHeight(data.Height || \"\");\r\n        setWeight(data.Weight || \"\");\r\n        setBloodType(data.Blood_Type || \"\");\r\n        setEmergencyContact(data.Emergency_Contact || \"\");\r\n      }\r\n    };\r\n\r\n    fetchProfile();\r\n  }, [userId]);\r\n\r\n  const handleUpdate = async (e) => {\r\n    e.preventDefault();\r\n\r\n    if (!userId) {\r\n      setFormError(\"User not logged in\");\r\n      return;\r\n    }\r\n\r\n    const { data: existing } = await supabase\r\n      .from(\"Patient\")\r\n      .select(\"User_ID\")\r\n      .eq(\"User_ID\", userId)\r\n      .single();\r\n\r\n    let result;\r\n    if (existing) {\r\n      result = await supabase\r\n        .from(\"Patient\")\r\n        .update({\r\n          Height: height,\r\n          Weight: weight,\r\n          Blood_Type: bloodType,\r\n          Emergency_Contact: emergencyContact\r\n        })\r\n        .eq(\"User_ID\", userId);\r\n    } else {\r\n      result = await supabase\r\n        .from(\"Patient\")\r\n        .insert({\r\n          User_ID: userId,\r\n          Height: height,\r\n          Weight: weight,\r\n          Blood_Type: bloodType,\r\n          Emergency_Contact: emergencyContact,\r\n          Referential_Code: 0  // or generate if needed\r\n        });\r\n    }\r\n\r\n    if (result.error) {\r\n      console.log(result.error);\r\n      setFormError(\"Update failed\");\r\n    } else {\r\n      setFormError(null);\r\n      navigate(\"/\");  // or wherever you want to redirect\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"update-profile\">\r\n      <h2>Update Patient Profile</h2>\r\n      <form onSubmit={handleUpdate}>\r\n        <label>Height (cm):</label>\r\n        <input \r\n          type=\"number\" \r\n          value={height} \r\n          onChange={(e) => setHeight(e.target.value)} \r\n        />\r\n\r\n        <label>Weight (kg):</label>\r\n        <input \r\n          type=\"number\" \r\n          value={weight} \r\n          onChange={(e) => setWeight(e.target.value)} \r\n        />\r\n\r\n        <label>Blood Type:</label>\r\n        <select \r\n          value={bloodType} \r\n          onChange={(e) => setBloodType(e.target.value)}\r\n        >\r\n          <option value=\"\">Select blood type</option>\r\n          <option value=\"A+\">A+</option>\r\n          <option value=\"A-\">A-</option>\r\n          <option value=\"B+\">B+</option>\r\n          <option value=\"B-\">B-</option>\r\n          <option value=\"AB+\">AB+</option>\r\n          <option value=\"AB-\">AB-</option>\r\n          <option value=\"O+\">O+</option>\r\n          <option value=\"O-\">O-</option>\r\n        </select>\r\n\r\n        <label>Emergency Contact:</label>\r\n        <input \r\n          type=\"text\" \r\n          placeholder=\"+880 1X XXXXXXXX\"\r\n          value={emergencyContact} \r\n          onChange={(e) => setEmergencyContact(e.target.value)} \r\n        />\r\n\r\n        <button type=\"submit\">Update Profile</button>\r\n\r\n        {formError && <p className=\"error\">{formError}</p>}\r\n      </form>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default UpdateProfile2;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}